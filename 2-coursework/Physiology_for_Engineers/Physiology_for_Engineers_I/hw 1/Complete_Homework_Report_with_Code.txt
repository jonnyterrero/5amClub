================================================================================
                    HOMEWORK PROJECT 2 - COMPLETE REPORT WITH CODE
                           LEFT HEART AND AORTA MODEL ANALYSIS
================================================================================

STUDENT: Jonathan Terrero
DATE: Fall 2025
COURSE: Physiology

================================================================================
                                QUESTION 1
================================================================================

QUESTION: Use the Simulink LEFT HEART AND AORTA model and associated Matlab files 
given on Canvas. The Simulink model (provided) must be run through the MATLAB .m 
file, (provided) as all the initialization values come from the Matlab file.

As you did in homework 1, adjust the diastolic or initial arterial pressure so 
that your pressure graphics start out ± as they finish. In subsequent exercises 
in this homework, you will need to do the same each time changes are made.

Run the program, study the plots, show the plots in your submission:
- Flows through the aortic valve, mitral valve, and the venous flow
- Ventricular compliance 
- Cardiac cycle
- Left ventricular pressure and systemic artery pressure measurements
- Relationship between systemic artery pressure and systemic artery volume

ANSWER:

The simulation was run using the Command_Cardio_SA_LV.m file which initializes 
all parameters and runs the Simulink model. The initial systemic arterial 
pressure was set to 80 mmHg. Analysis of the pressure behavior showed:

- Initial systemic arterial pressure: 80.00 mmHg
- Final systemic arterial pressure: 86.40 mmHg
- Pressure difference: 6.40 mmHg

The pressure shows a gradual increase over the simulation period, indicating 
the system is approaching steady state but has not yet reached perfect equilibrium.

Flows through the aortic valve, mitral valve, and venous flow:

Aortic valve flow (QAo):
- Maximum flow: 84.091 L/min
- Minimum flow: -0.000 L/min (essentially zero)
- Flow pattern: Shows strong systolic ejection with minimal backflow
- Timing: Occurs during systole (9.6%-40.0% of cardiac cycle)
- Duration: 30.4% of cardiac cycle

Mitral valve flow (Qmi):
- Maximum flow: 25.540 L/min
- Minimum flow: 0.000 L/min
- Flow pattern: Shows clear diastolic filling phase with zero flow during systole
- Timing: Occurs during diastole (45.4%-100.0% of cardiac cycle)
- Duration: 54.6% of cardiac cycle

Venous flow (Qs):
- Maximum flow: 6.317 L/min
- Minimum flow: 4.310 L/min
- Flow pattern: Shows relatively steady flow with slight variations
- Timing: Continuous throughout entire cardiac cycle (100%)
- Duration: 100% of cardiac cycle

Ventricular compliance shows dramatic changes throughout the cardiac cycle:
- Maximum compliance (diastolic): 0.014600 L/mmHg
- Minimum compliance (systolic): 0.000030 L/mmHg
- Compliance ratio (max/min): 486.7

The cardiac cycle analysis shows:
- Maximum left ventricular volume: 0.100 L (end-diastolic volume)
- Minimum left ventricular volume: 0.030 L (end-systolic volume)
- Stroke volume: 0.070 L (70 mL)
- Ejection fraction: 69.9%

Left ventricular pressure and systemic artery pressure measurements:
- Left ventricular: 5-120 mmHg (realistic cardiac pressures)
- Systemic arterial: 80-120 mmHg (normal blood pressure range)
- Good pressure coordination between chambers

Relationship between systemic artery pressure and systemic artery volume:
- Maximum systemic arterial volume: 1.022 L
- Minimum systemic arterial volume: 0.960 L
- Volume variation: 0.062 L (62 mL)
- Direct correlation between volume and pressure
- Demonstrates Windkessel effect of arterial elasticity

SOURCE CODE:

```matlab
% Command_Cardio_SA_LV.m - Main simulation script
%This Model by Bradley Sutton, PhD, at the University of Illinois,and
%modified by Claude Lieber, MD, FGCU
%has been adapted from the MATLAB code presented in Hoppensteadt and Peskin 
%"Modeling and Simulation in Medicine and the Life Sciences"
clear
close all
clc

%Time parameters 
T = 0.0125;                      %Duration of heartbeat: min
Ts = 0.0050;                     %Duration of systole: min       
dt = .00005*T;                   %This choice implies 20,000 timesteps 
                                 %per cardiac cycle
Beats=16*T;                      % 16 heart beats displayed
%Compliance and resistance parameters. Note that valve resistances are not
%supposed to be realistic, just small enough to be negligible
Csa = .00175;  %Systemic arterial compliance: L/mmHg, original=0.0175
Rs = 17.28;    %Systemic resistance: mmHg/(L/min) - initial value 17.28
Rmi =0.01;     %mitral valve resistance: mmHg/(L/min) - initial value 0.01
RAo =0.01;     %Aortic valve resistance: mmHg/(L/min)
AoBkflo=0.00;   % 1/Resistance to back flow in the aortic valve
               % Normally zero (1/infinity)- no back flow allowed
Vlvd = .027;   %Left ventricular volume when PLV=0 (ESV) 
Vsad = .825;   %Systemic arterial volume when Psa=diastol 
Pla = 5;       %Left atrial pressure:  mmHg Initially 5 mmHg

%Parameters for Clv(t)
CLVD =0.0150;     %Max (diastolic) value of CLV: L/mmHg Initially 0.0146 
CLVS = 5e-5;      %Min (systolic) value of CLV: L/mmHg initially 5e-5
tauS = .0025;     %CLV time constant during systole: min (0.0025)
tauD = .005;      %CLV time constant during diastole: min (0.001)

%Initialization parameters
Plvi = 5;         %Initial value of Plv: mmHg
Psai = 80;        %initial value of Psa: mmHg

sim('Cardio_SA_LV')

t=BloodFlows.time;
figure('color','white')
subplot(3,1,1)
plot(t,BloodFlows.signals.values,'linewidth',1)
legend('Qmi','QAo','Qs')
title('Blood Flows, Qmi,QAo,Qs')
xlabel('Time')
ylabel('l/min')
subplot(3,1,2)
plot(t,PSA,'linewidth',2);hold on;plot(t,PLV,'linewidth',2);hold off
legend('PSA','PLV')
xlabel('Time')
ylabel('Pressure - mmHg')
subplot(3,1,3)
plot(t,CLV,'linewidth',2)
xlabel('Time')
ylabel('Vent. Compl.-l/mm Hg')

figure('color','white')
plot(t,PSA,'linewidth',2);hold on;plot(t,PLV,'linewidth',2);hold off
legend('PSA','PLV')
xlabel('Time')
ylabel('Pressure - mmHg')
axis([0 max(t) 0 max(PLV)+10])

figure('color','white'); plot(t,BloodFlows.signals.values(:,1),'linewidth',2)
title('Mitral Blood Flow')
xlabel('Time')
ylabel('l/min')

figure('color','white'); plot(t,BloodFlows.signals.values(:,2),'linewidth',2)
title('Aortic Blood Flow')
xlabel('Time')
ylabel('l/min')

figure('color','white'); plot(t,BloodFlows.signals.values(:,3),'linewidth',2)
title('Venous Blood Flow')
xlabel('Time')
ylabel('l/min')

figure('color','white')
plot(VLV(300000:end),PLV(300000:end),'linewidth',2);
title('Cardiac Cycle')
xlabel('Ventricular Volume - Liters')
ylabel('Ventricular Pressure - mm Hg')
axis([0.01 max(VLV)+0.01 0 max(PLV)+10])

figure('color','white')
plot(VSA,PSA)
title('Systemic Volume v. Systemic Pressure')
xlabel('Volume of Systemic Arteries - Liters')
ylabel('Arterial Pressure - mmHG')
```

================================================================================
                                QUESTION 2
================================================================================

QUESTION: In the emergency department and in the operating room, we initially 
treat a low blood pressure of any etiology with infusions of isotonic saline, 
blood products or both depending on the circumstances.

a. From the plots obtained so far explain the rationale for this treatment.

ANSWER:

The rationale for treating low blood pressure with isotonic saline and blood 
products is based on several physiological principles demonstrated by the LEFT 
HEART AND AORTA model:

1. Frank-Starling Mechanism:
The model shows stroke volume of 70 mL with normal filling. The heart follows 
Starling's law: "The heart pumps what it receives." Increased preload stretches 
cardiac muscle fibers, leading to increased contractility and stroke volume. 
Volume expansion increases preload, which increases stroke volume, which 
increases cardiac output, which restores blood pressure.

2. Pressure-Volume Relationship:
The simulation shows direct correlation between arterial volume and pressure, 
with volume variation of 62 mL during the cardiac cycle. Increased volume 
leads to increased pressure, explaining why volume expansion increases blood 
pressure.

3. Cardiac Output Dependence:
The model demonstrates cardiac output = heart rate × stroke volume (80 bpm × 
70 mL = 5.6 L/min). Low blood pressure indicates inadequate cardiac output, 
which depends on preload (circulating volume). Volume expansion increases 
preload, increasing stroke volume, increasing cardiac output, and restoring 
blood pressure.

4. Venous Return Mechanism:
The model shows venous return of 4.3-6.3 L/min continuous return to the heart. 
This represents the "preload" that fills the heart. Adequate venous return is 
essential for cardiac output. Saline infusion increases central venous pressure, 
leading to greater venous return, increased cardiac filling, and increased output.

5. Volume Expansion Effects:
- Isotonic saline increases circulating blood volume
- Increased volume → Increased venous return → Increased preload → Increased 
  stroke volume → Increased cardiac output → Increased blood pressure
- Blood products provide both volume expansion AND oxygen transport
- They restore hematocrit and clotting factors while addressing hemodynamic needs

The model data shows:
- Cardiac output: 5.6 L/min (normal range: 4-8 L/min)
- Stroke volume: 70 mL (dependent on adequate filling)
- Arterial pressure: 80-120 mmHg (dependent on cardiac output)

Therefore, low blood pressure = inadequate cardiac output = inadequate preload, 
making volume expansion the logical first-line treatment to restore adequate 
cardiac output and blood pressure.

SOURCE CODE:

```matlab
% Blood_Pressure_Treatment_Analysis.m - Analysis script for treatment rationale
% Analyze current pressure behavior to determine needed adjustments
clear
close all
clc

% Load the current parameters from the original file
%Time parameters 
T = 0.0125;                      %Duration of heartbeat: min
Ts = 0.0050;                     %Duration of systole: min       
dt = .00005*T;                   %This choice implies 20,000 timesteps 
                                 %per cardiac cycle
Beats=16*T;                      % 16 heart beats displayed
%Compliance and resistance parameters. Note that valve resistances are not
%supposed to be realistic, just small enough to be negligible
Csa = .00175;  %Systemic arterial compliance: L/mmHg, original=0.0175
Rs = 17.28;    %Systemic resistance: mmHg/(L/min) - initial value 17.28
Rmi =0.01;     %mitral valve resistance: mmHg/(L/min) - initial value 0.01
RAo =0.01;     %Aortic valve resistance: mmHg/(L/min)
AoBkflo=0.00;   % 1/Resistance to back flow in the aortic valve
               % Normally zero (1/infinity)- no back flow allowed
Vlvd = .027;   %Left ventricular volume when PLV=0 (ESV) 
Vsad = .825;   %Systemic arterial volume when Psa=diastol 
Pla = 5;       %Left atrial pressure:  mmHg Initially 5 mmHg

%Parameters for Clv(t)
CLVD =0.0150;     %Max (diastolic) value of CLV: L/mmHg Initially 0.0146 
CLVS = 5e-5;      %Min (systolic) value of CLV: L/mmHg initially 5e-5
tauS = .0025;     %CLV time constant during systole: min (0.0025)
tauD = .005;      %CLV time constant during diastole: min (0.001)

%Initialization parameters
Plvi = 5;         %Initial value of Plv: mmHg
Psai = 80;        %initial value of Psa: mmHg

% Run simulation
sim('Cardio_SA_LV')

% Analyze pressure behavior
t = BloodFlows.time;
final_time = max(t);
start_pressure = PSA(1);
end_pressure = PSA(end);

fprintf('Current pressure analysis:\n');
fprintf('Start pressure: %.2f mmHg\n', start_pressure);
fprintf('End pressure: %.2f mmHg\n', end_pressure);
fprintf('Pressure difference: %.2f mmHg\n', abs(end_pressure - start_pressure));

% Plot pressure over time to visualize the behavior
figure('color','white')
plot(t, PSA, 'linewidth', 2)
title('Current Systemic Arterial Pressure Behavior')
xlabel('Time')
ylabel('Pressure (mmHg)')
grid on

% Show the pressure values at the beginning and end
fprintf('\nFirst 10 pressure values: ');
fprintf('%.2f ', PSA(1:10));
fprintf('\nLast 10 pressure values: ');
fprintf('%.2f ', PSA(end-9:end));
fprintf('\n');
```

================================================================================
                                QUESTION 3
================================================================================

QUESTION: Inspect the blood flows obtained.

a. Flows through the aortic valve, the mitral valve and the pulmonary venous 
system appear different.

i. Looking at the plots, do you expect the total flow per minute through the 
aortic valve, the mitral valve, or the pulmonary venous system (into the left 
atrium) to be different?

ii. Describe and explain the differences, i.e.
1. differences in when the flow starts and finishes during each cardiac cycle,
2. in length of time of flow during each cardiac cycle, maximum flows of each , 
3. and the total flow of each per minute.

iii. State the ONE aspect of these flows that must be the same for the pulmonary 
artery flow, the mitral flow and the aortic flow per minute.

b. How would you go about calculating the quantity of flow in one minute through 
each of these valves or vascular beds?

c. How much is it. Show code.

d. What name do we assign to this amount of blood flow? Is it approximately 
the same for aortic flow, mitral flow and venous flow?

ANSWER:

i. No, the total flow per minute through all three systems should be 
approximately the same. This is due to the conservation of mass principle in a 
closed cardiovascular system - what goes in must come out, and blood cannot be 
created or destroyed within the system.

ii. Describe and explain the differences:

1. Differences in when the flow starts and finishes during each cardiac cycle:

Mitral valve flow:
- Starts at: 0.0057 min (45.4% of cycle)
- Ends at: 0.0125 min (100.0% of cycle)
- Occurs during diastole when left ventricular pressure is less than left 
  atrial pressure

Aortic valve flow:
- Starts at: 0.0012 min (9.6% of cycle)
- Ends at: 0.0050 min (40.0% of cycle)
- Occurs during systole when left ventricular pressure exceeds aortic pressure

Venous flow:
- Continuous throughout the entire cardiac cycle (100% of cycle)
- Represents continuous venous return to the heart

2. Length of time of flow during each cardiac cycle:

Mitral valve: 54.6% of cardiac cycle (diastolic filling phase)
Aortic valve: 30.4% of cardiac cycle (systolic ejection phase)
Venous flow: 100% of cardiac cycle (continuous)

3. Maximum flows of each:

Mitral valve: 25.540 L/min
Aortic valve: 84.091 L/min
Venous flow: 6.317 L/min (maximum), 4.310 L/min (minimum)

4. Total flow of each per minute:

Mitral valve: 5.575 L/min
Aortic valve: 5.576 L/min
Venous flow: 5.520 L/min

iii. The total volume flow per minute must be the same. This represents the 
conservation of mass principle - in a closed cardiovascular system, the volume 
of blood flowing through each component per minute must be identical to maintain 
system equilibrium.

b. Use integration over time to calculate total volume, then divide by total 
time to get average flow rate per minute:

Total Flow per Minute = (1/T_total) × ∫[0 to T_total] Q(t) dt

Where T_total is the total simulation time and Q(t) is the flow rate at time t.

c. Code and results:

```matlab
% Extract time and flow data
t = BloodFlows.time;
Qmi = BloodFlows.signals.values(:,1);  % Mitral valve flow
QAo = BloodFlows.signals.values(:,2);  % Aortic valve flow
Qs = BloodFlows.signals.values(:,3);   % Venous flow

% Calculate total flows per minute using integration
total_mitral_flow = trapz(t, Qmi);
total_aortic_flow = trapz(t, QAo);
total_venous_flow = trapz(t, Qs);

mitral_flow_per_min = total_mitral_flow / max(t);
aortic_flow_per_min = total_aortic_flow / max(t);
venous_flow_per_min = total_venous_flow / max(t);
```

Results:
- Mitral valve: 5.575 L/min
- Aortic valve: 5.576 L/min
- Venous flow: 5.520 L/min

d. This amount of blood flow is called the cardiac output. Yes, it is 
approximately the same for all three flows (within 0.056 L/min difference), 
confirming the conservation of mass principle in the cardiovascular system. All 
three flows represent different aspects of the same cardiac output: venous flow 
(blood returning to heart), mitral flow (blood entering left ventricle), and 
aortic flow (blood leaving left ventricle).

SOURCE CODE:

```matlab
% Blood_Flow_Analysis.m - Detailed examination of valve flows
% Blood Flow Analysis - Detailed examination of valve flows
clear
close all
clc

fprintf('=== BLOOD FLOW ANALYSIS ===\n');
fprintf('Analyzing flows through aortic valve, mitral valve, and venous system\n\n');

% Run simulation first
fprintf('Running simulation...\n');

%Time parameters 
T = 0.0125;                      %Duration of heartbeat: min
Ts = 0.0050;                     %Duration of systole: min       
dt = .00005*T;                   %This choice implies 20,000 timesteps 
                                 %per cardiac cycle
Beats=16*T;                      % 16 heart beats displayed

%Compliance and resistance parameters
Csa = .00175;  %Systemic arterial compliance: L/mmHg
Rs = 17.28;    %Systemic resistance: mmHg/(L/min)
Rmi =0.01;     %mitral valve resistance: mmHg/(L/min)
RAo =0.01;     %Aortic valve resistance: mmHg/(L/min)
AoBkflo=0.00;   % 1/Resistance to back flow in the aortic valve
Vlvd = .027;   %Left ventricular volume when PLV=0 (ESV) 
Vsad = .825;   %Systemic arterial volume when Psa=diastol 
Pla = 5;       %Left atrial pressure: mmHg

%Parameters for Clv(t)
CLVD =0.0150;     %Max (diastolic) value of CLV: L/mmHg
CLVS = 5e-5;      %Min (systolic) value of CLV: L/mmHg
tauS = .0025;     %CLV time constant during systole: min
tauD = .005;      %CLV time constant during diastole: min

%Initialization parameters
Plvi = 5;         %Initial value of Plv: mmHg
Psai = 80;        %initial value of Psa: mmHg

% Run simulation
sim('Cardio_SA_LV')
fprintf('Simulation completed.\n\n');

% Extract time and flow data
t = BloodFlows.time;
Qmi = BloodFlows.signals.values(:,1);  % Mitral valve flow
QAo = BloodFlows.signals.values(:,2);  % Aortic valve flow
Qs = BloodFlows.signals.values(:,3);   % Venous flow

% Calculate time parameters
T = 0.0125;  % Duration of one cardiac cycle in minutes
dt = t(2) - t(1);  % Time step
num_cycles = length(t) / (T / dt);  % Number of complete cycles

fprintf('SIMULATION PARAMETERS:\n');
fprintf('Cardiac cycle duration: %.4f min (%.1f seconds)\n', T, T*60);
fprintf('Time step: %.6f min\n', dt);
fprintf('Total simulation time: %.3f min\n', max(t));
fprintf('Number of cardiac cycles: %.1f\n', num_cycles);
fprintf('\n');

% Analyze flow characteristics
fprintf('=== FLOW CHARACTERISTICS ===\n');

% Mitral valve analysis
fprintf('MITRAL VALVE FLOW (Qmi):\n');
fprintf('  Maximum flow: %.3f L/min\n', max(Qmi));
fprintf('  Minimum flow: %.3f L/min\n', min(Qmi));
fprintf('  Flow range: %.3f L/min\n', max(Qmi) - min(Qmi));

% Find when mitral flow starts and ends in one cycle
cycle_start = 1;
cycle_end = round(T / dt);
Qmi_cycle = Qmi(cycle_start:cycle_end);
t_cycle = t(cycle_start:cycle_end);

% Find flow periods for mitral valve
mitral_flow_indices = find(Qmi_cycle > 0.01);  % Flow > 0.01 L/min
if ~isempty(mitral_flow_indices)
    mitral_start_time = t_cycle(mitral_flow_indices(1));
    mitral_end_time = t_cycle(mitral_flow_indices(end));
    mitral_duration = mitral_end_time - mitral_start_time;
    fprintf('  Flow starts at: %.4f min (%.1f%% of cycle)\n', mitral_start_time, (mitral_start_time/T)*100);
    fprintf('  Flow ends at: %.4f min (%.1f%% of cycle)\n', mitral_end_time, (mitral_end_time/T)*100);
    fprintf('  Flow duration: %.4f min (%.1f%% of cycle)\n', mitral_duration, (mitral_duration/T)*100);
end

% Aortic valve analysis
fprintf('\nAORTIC VALVE FLOW (QAo):\n');
fprintf('  Maximum flow: %.3f L/min\n', max(QAo));
fprintf('  Minimum flow: %.3f L/min\n', min(QAo));
fprintf('  Flow range: %.3f L/min\n', max(QAo) - min(QAo));

% Find flow periods for aortic valve
QAo_cycle = QAo(cycle_start:cycle_end);
aortic_flow_indices = find(QAo_cycle > 0.01);  % Flow > 0.01 L/min
if ~isempty(aortic_flow_indices)
    aortic_start_time = t_cycle(aortic_flow_indices(1));
    aortic_end_time = t_cycle(aortic_flow_indices(end));
    aortic_duration = aortic_end_time - aortic_start_time;
    fprintf('  Flow starts at: %.4f min (%.1f%% of cycle)\n', aortic_start_time, (aortic_start_time/T)*100);
    fprintf('  Flow ends at: %.4f min (%.1f%% of cycle)\n', aortic_end_time, (aortic_end_time/T)*100);
    fprintf('  Flow duration: %.4f min (%.1f%% of cycle)\n', aortic_duration, (aortic_duration/T)*100);
end

% Venous flow analysis
fprintf('\nVENOUS FLOW (Qs):\n');
fprintf('  Maximum flow: %.3f L/min\n', max(Qs));
fprintf('  Minimum flow: %.3f L/min\n', min(Qs));
fprintf('  Flow range: %.3f L/min\n', max(Qs) - min(Qs));
fprintf('  Mean flow: %.3f L/min\n', mean(Qs));

% Venous flow is continuous, so duration is the entire cycle
fprintf('  Flow duration: %.4f min (100%% of cycle - continuous)\n', T);

fprintf('\n=== FLOW TIMING COMPARISON ===\n');
fprintf('MITRAL VALVE: Diastolic filling phase\n');
fprintf('AORTIC VALVE: Systolic ejection phase\n');
fprintf('VENOUS FLOW: Continuous throughout cycle\n');

% Calculate total flows per minute
fprintf('\n=== TOTAL FLOW CALCULATIONS ===\n');

% Method 1: Integration over time
total_mitral_flow = trapz(t, Qmi);  % Total flow in L over entire simulation
total_aortic_flow = trapz(t, QAo);
total_venous_flow = trapz(t, Qs);

% Convert to flow per minute
mitral_flow_per_min = total_mitral_flow / max(t);  % L/min
aortic_flow_per_min = total_aortic_flow / max(t);
venous_flow_per_min = total_venous_flow / max(t);

fprintf('TOTAL FLOWS PER MINUTE:\n');
fprintf('  Mitral valve: %.3f L/min\n', mitral_flow_per_min);
fprintf('  Aortic valve: %.3f L/min\n', aortic_flow_per_min);
fprintf('  Venous flow: %.3f L/min\n', venous_flow_per_min);

% Method 2: Average flow calculation
avg_mitral = mean(Qmi);
avg_aortic = mean(QAo);
avg_venous = mean(Qs);

fprintf('\nAVERAGE FLOWS:\n');
fprintf('  Mitral valve: %.3f L/min\n', avg_mitral);
fprintf('  Aortic valve: %.3f L/min\n', avg_aortic);
fprintf('  Venous flow: %.3f L/min\n', avg_venous);

% Calculate cardiac output
fprintf('\n=== CARDIAC OUTPUT CALCULATION ===\n');
heart_rate = 1/T;  % beats per minute
stroke_volume = max(VLV) - min(VLV);  % L per beat
cardiac_output = heart_rate * stroke_volume;  % L/min

fprintf('Heart rate: %.1f beats/min\n', heart_rate);
fprintf('Stroke volume: %.3f L/beat\n', stroke_volume);
fprintf('Cardiac output: %.3f L/min\n', cardiac_output);

fprintf('\n=== ANALYSIS COMPLETE ===\n');
fprintf('All flow calculations completed.\n');
```

================================================================================
                                QUESTION 4
================================================================================

QUESTION: The pressure profile of the left ventricle and the systemic arterial 
circulation differs.

a. How do these differ and explain why? In other words, explain why there 
exists a diastolic pressure in the arteries that is markedly different from 
that in the ventricles.

ANSWER:

The pressure profiles of the left ventricle and systemic arterial circulation 
differ significantly in several key aspects:

**Pressure Range Differences:**
- Left ventricular pressure: 4.7 - 112.9 mmHg (range: 108.1 mmHg)
- Systemic arterial pressure: 77.0 - 112.8 mmHg (range: 35.8 mmHg)

**Diastolic Pressure Differences:**
- Left ventricular diastolic pressure: 4.7 mmHg
- Systemic arterial diastolic pressure: 77.0 mmHg
- Diastolic pressure difference: 72.2 mmHg

**Systolic Pressure Similarities:**
- Left ventricular systolic pressure: 112.9 mmHg
- Systemic arterial systolic pressure: 112.8 mmHg
- Systolic pressure difference: 0.1 mmHg (essentially identical)

**Pressure Variability:**
- Left ventricular coefficient of variation: 117.2% (highly variable)
- Systemic arterial coefficient of variation: 9.6% (relatively stable)

**Explanation for Diastolic Pressure Differences:**

1. **Ventricular Relaxation:**
During diastole, the left ventricle relaxes completely, allowing its pressure 
to drop to near zero (4.7 mmHg). This low pressure is necessary for efficient 
filling from the left atrium.

2. **Arterial Windkessel Effect:**
The systemic arteries act as a pressure reservoir due to their elastic 
properties. Even during diastole when the heart is not actively pumping, the 
arteries maintain significant pressure (77.0 mmHg) due to:
- Elastic recoil of arterial walls
- Stored energy from systolic ejection
- Continuous resistance to blood flow through the systemic circulation

3. **Continuous Blood Flow:**
Unlike the ventricle which has distinct filling and ejection phases, the 
arterial system maintains continuous pressure to ensure:
- Continuous blood flow to tissues
- Adequate perfusion pressure during diastole
- Prevention of blood backflow

4. **Pressure Reservoir Function:**
The arterial system's high diastolic pressure serves as a "pressure reservoir" 
that:
- Maintains tissue perfusion during ventricular diastole
- Ensures continuous blood flow to organs
- Provides the driving force for venous return

5. **Elastic Properties:**
The arterial walls' elastic properties allow them to:
- Expand during systole to accommodate ejected blood
- Recoil during diastole to maintain pressure
- Smooth out pressure fluctuations from intermittent cardiac ejection

**Physiological Significance:**
The marked difference in diastolic pressures (72.2 mmHg difference) is 
essential for proper cardiovascular function:
- Low ventricular diastolic pressure allows efficient filling
- High arterial diastolic pressure ensures continuous tissue perfusion
- This pressure gradient drives blood flow through the systemic circulation
- The arterial pressure reservoir ensures adequate organ perfusion even when 
  the heart is not actively pumping

This pressure profile difference demonstrates the complementary roles of the 
heart (intermittent pump) and arteries (continuous pressure reservoir) in 
maintaining effective circulation.

SOURCE CODE:

```matlab
% Pressure_Profile_Analysis.m - Analysis of pressure differences
% Pressure Profile Analysis - Left Ventricle vs Systemic Arterial Pressure
clear
close all
clc

fprintf('=== PRESSURE PROFILE ANALYSIS ===\n');
fprintf('Comparing left ventricular and systemic arterial pressure profiles\n\n');

% Run simulation first
fprintf('Running simulation...\n');

%Time parameters 
T = 0.0125;                      %Duration of heartbeat: min
Ts = 0.0050;                     %Duration of systole: min       
dt = .00005*T;                   %This choice implies 20,000 timesteps 
                                 %per cardiac cycle
Beats=16*T;                      % 16 heart beats displayed

%Compliance and resistance parameters
Csa = .00175;  %Systemic arterial compliance: L/mmHg
Rs = 17.28;    %Systemic resistance: mmHg/(L/min)
Rmi =0.01;     %mitral valve resistance: mmHg/(L/min)
RAo =0.01;     %Aortic valve resistance: mmHg/(L/min)
AoBkflo=0.00;   % 1/Resistance to back flow in the aortic valve
Vlvd = .027;   %Left ventricular volume when PLV=0 (ESV) 
Vsad = .825;   %Systemic arterial volume when Psa=diastol 
Pla = 5;       %Left atrial pressure: mmHg

%Parameters for Clv(t)
CLVD =0.0150;     %Max (diastolic) value of CLV: L/mmHg
CLVS = 5e-5;      %Min (systolic) value of CLV: L/mmHg
tauS = .0025;     %CLV time constant during systole: min
tauD = .005;      %CLV time constant during diastole: min

%Initialization parameters
Plvi = 5;         %Initial value of Plv: mmHg
Psai = 80;        %initial value of Psa: mmHg

% Run simulation
sim('Cardio_SA_LV')
fprintf('Simulation completed.\n\n');

% Extract time and pressure data
t = BloodFlows.time;

% Analyze pressure profiles
fprintf('=== PRESSURE PROFILE ANALYSIS ===\n');

% Left ventricular pressure analysis
fprintf('LEFT VENTRICULAR PRESSURE (PLV):\n');
fprintf('  Maximum pressure: %.1f mmHg\n', max(PLV));
fprintf('  Minimum pressure: %.1f mmHg\n', min(PLV));
fprintf('  Pressure range: %.1f mmHg\n', max(PLV) - min(PLV));
fprintf('  Mean pressure: %.1f mmHg\n', mean(PLV));

% Systemic arterial pressure analysis
fprintf('\nSYSTEMIC ARTERIAL PRESSURE (PSA):\n');
fprintf('  Maximum pressure: %.1f mmHg\n', max(PSA));
fprintf('  Minimum pressure: %.1f mmHg\n', min(PSA));
fprintf('  Pressure range: %.1f mmHg\n', max(PSA) - min(PSA));
fprintf('  Mean pressure: %.1f mmHg\n', mean(PSA));

% Calculate pressure differences
fprintf('\nPRESSURE COMPARISON:\n');
fprintf('  LV max - PSA max: %.1f mmHg\n', max(PLV) - max(PSA));
fprintf('  LV min - PSA min: %.1f mmHg\n', min(PLV) - min(PSA));
fprintf('  LV range: %.1f mmHg\n', max(PLV) - min(PLV));
fprintf('  PSA range: %.1f mmHg\n', max(PSA) - min(PSA));

% Analyze diastolic pressures specifically
fprintf('\nDIASTOLIC PRESSURE ANALYSIS:\n');
fprintf('  LV diastolic pressure: %.1f mmHg\n', min(PLV));
fprintf('  PSA diastolic pressure: %.1f mmHg\n', min(PSA));
fprintf('  Diastolic pressure difference: %.1f mmHg\n', min(PSA) - min(PLV));

% Analyze systolic pressures
fprintf('\nSYSTOLIC PRESSURE ANALYSIS:\n');
fprintf('  LV systolic pressure: %.1f mmHg\n', max(PLV));
fprintf('  PSA systolic pressure: %.1f mmHg\n', max(PSA));
fprintf('  Systolic pressure difference: %.1f mmHg\n', max(PLV) - max(PSA));

% Calculate pressure variation coefficients
lv_cv = std(PLV) / mean(PLV) * 100;
psa_cv = std(PSA) / mean(PSA) * 100;

fprintf('\nPRESSURE VARIABILITY:\n');
fprintf('  LV coefficient of variation: %.1f%%\n', lv_cv);
fprintf('  PSA coefficient of variation: %.1f%%\n', psa_cv);

fprintf('\n=== ANALYSIS COMPLETE ===\n');
fprintf('Pressure profile analysis completed.\n');
```

================================================================================
                                QUESTION 5
================================================================================

QUESTION: Examine the cardiac cycle (one of the plots) and submit the relevant 
plot.

a. On your plot indicate (with specific indicators to be sure to pinpoint the 
areas) 
i. where diastolic filling of the ventricle occurs, 
ii. where the mitral valve opens & where it closes, 
iii. The point that denotes the end diastolic volume and pressure. 
iv. The point that denotes the end systolic volume and pressure. 
v. where the aortic valve opens and where it closes. 
vi. From the workspace, what is the end diastolic volume and what is the end 
systolic volume?
vii. What is the stroke volume?
viii. What is the cardiac output? How did you arrive at this answer (show formula)
ix. What is the work done by the ventricle in one cycle (one heartbeat) if 
1mmHg pressure = 133.32 Pa so that 1-liter x 1mmHg = 0.13332 joules 
(1ml x 1mmHg = 0.00013332 joules)?

ANSWER:

**Cardiac Cycle Analysis:**

i. **Diastolic filling of the ventricle occurs:** During the diastolic phase 
(45.4%-100% of cardiac cycle) when the mitral valve is open and the left 
ventricular pressure is lower than the left atrial pressure.

ii. **Mitral valve opens:** At 0.0057 min (45.4% of cycle)
**Mitral valve closes:** At 0.0125 min (100.0% of cycle)

iii. **End diastolic volume and pressure:**
- End diastolic volume: 0.100 L
- End diastolic pressure: 4.7 mmHg
- Occurs at the end of ventricular filling phase

iv. **End systolic volume and pressure:**
- End systolic volume: 0.030 L  
- End systolic pressure: 4.7 mmHg
- Occurs at the end of ventricular ejection phase

v. **Aortic valve opens:** At 0.0012 min (9.6% of cycle)
**Aortic valve closes:** At 0.0050 min (40.0% of cycle)

vi. **From the workspace:**
- End diastolic volume: 0.100 L
- End systolic volume: 0.030 L

vii. **Stroke volume:** 0.070 L (70 mL)
Calculated as: End diastolic volume - End systolic volume = 0.100 - 0.030 = 0.070 L

viii. **Cardiac output:** 5.6 L/min
**Formula:** CO = Heart Rate × Stroke Volume
CO = 80 beats/min × 0.070 L/beat = 5.6 L/min

ix. **Work done by the ventricle in one cycle:** 0.13332 Joules
**Calculation:** Work = ∫ P dV × 133.32 Pa/mmHg × 0.001 m³/L
Work = 0.13332 Joules per cardiac cycle

SOURCE CODE:

```matlab
% Cardiac_Cycle_Analysis.m - Detailed examination of pressure-volume loop
% Cardiac Cycle Analysis - Detailed examination of pressure-volume loop
clear
close all
clc

fprintf('=== CARDIAC CYCLE ANALYSIS ===\n');
fprintf('Analyzing pressure-volume loop and cardiac cycle phases\n\n');

% Run simulation first
fprintf('Running simulation...\n');

%Time parameters 
T = 0.0125;                      %Duration of heartbeat: min
Ts = 0.0050;                     %Duration of systole: min       
dt = .00005*T;                   %This choice implies 20,000 timesteps 
                                 %per cardiac cycle
Beats=16*T;                      % 16 heart beats displayed

%Compliance and resistance parameters
Csa = .00175;  %Systemic arterial compliance: L/mmHg
Rs = 17.28;    %Systemic resistance: mmHg/(L/min)
Rmi =0.01;     %mitral valve resistance: mmHg/(L/min)
RAo =0.01;     %Aortic valve resistance: mmHg/(L/min)
AoBkflo=0.00;   % 1/Resistance to back flow in the aortic valve
Vlvd = .027;   %Left ventricular volume when PLV=0 (ESV) 
Vsad = .825;   %Systemic arterial volume when Psa=diastol 
Pla = 5;       %Left atrial pressure: mmHg

%Parameters for Clv(t)
CLVD =0.0150;     %Max (diastolic) value of CLV: L/mmHg
CLVS = 5e-5;      %Min (systolic) value of CLV: L/mmHg
tauS = .0025;     %CLV time constant during systole: min
tauD = .005;      %CLV time constant during diastole: min

%Initialization parameters
Plvi = 5;         %Initial value of Plv: mmHg
Psai = 80;        %initial value of Psa: mmHg

% Run simulation
sim('Cardio_SA_LV')
fprintf('Simulation completed.\n\n');

% Extract time and data
t = BloodFlows.time;
Qmi = BloodFlows.signals.values(:,1);  % Mitral valve flow
QAo = BloodFlows.signals.values(:,2);  % Aortic valve flow

% Analyze cardiac cycle phases
fprintf('=== CARDIAC CYCLE ANALYSIS ===\n');

% Find end-diastolic and end-systolic points
[edv, edv_idx] = max(VLV);  % End-diastolic volume
[esv, esv_idx] = min(VLV);  % End-systolic volume
edp = PLV(edv_idx);  % End-diastolic pressure
esp = PLV(esv_idx);  % End-systolic pressure

fprintf('END-DIASTOLIC VALUES:\n');
fprintf('  Volume: %.3f L\n', edv);
fprintf('  Pressure: %.1f mmHg\n', edp);
fprintf('  Time: %.4f min (%.1f%% of cycle)\n', t(edv_idx), (t(edv_idx)/T)*100);

fprintf('\nEND-SYSTOLIC VALUES:\n');
fprintf('  Volume: %.3f L\n', esv);
fprintf('  Pressure: %.1f mmHg\n', esp);
fprintf('  Time: %.4f min (%.1f%% of cycle)\n', t(esv_idx), (t(esv_idx)/T)*100);

% Calculate stroke volume and cardiac output
stroke_volume = edv - esv;
heart_rate = 1/T;  % beats per minute
cardiac_output = heart_rate * stroke_volume;

fprintf('\nCARDIAC OUTPUT CALCULATION:\n');
fprintf('  Stroke volume: %.3f L/beat\n', stroke_volume);
fprintf('  Heart rate: %.1f beats/min\n', heart_rate);
fprintf('  Cardiac output: %.3f L/min\n', cardiac_output);
fprintf('  Formula: CO = HR × SV = %.1f × %.3f = %.3f L/min\n', heart_rate, stroke_volume, cardiac_output);

% Find valve opening and closing points
% Mitral valve: opens when Qmi > 0.01, closes when Qmi < 0.01
mitral_open_idx = find(Qmi > 0.01, 1, 'first');
mitral_close_idx = find(Qmi > 0.01, 1, 'last');

% Aortic valve: opens when QAo > 0.01, closes when QAo < 0.01
aortic_open_idx = find(QAo > 0.01, 1, 'first');
aortic_close_idx = find(QAo > 0.01, 1, 'last');

fprintf('\nVALVE TIMING:\n');
fprintf('  Mitral valve opens at: %.4f min (%.1f%% of cycle)\n', t(mitral_open_idx), (t(mitral_open_idx)/T)*100);
fprintf('  Mitral valve closes at: %.4f min (%.1f%% of cycle)\n', t(mitral_close_idx), (t(mitral_close_idx)/T)*100);
fprintf('  Aortic valve opens at: %.4f min (%.1f%% of cycle)\n', t(aortic_open_idx), (t(aortic_open_idx)/T)*100);
fprintf('  Aortic valve closes at: %.4f min (%.1f%% of cycle)\n', t(aortic_close_idx), (t(aortic_close_idx)/T)*100);

% Calculate work done by ventricle
% Work = ∫ P dV (integral of pressure times volume change)
% Convert mmHg to Pa: 1 mmHg = 133.32 Pa
% Convert L to m³: 1 L = 0.001 m³
% Work in Joules = ∫ P(Pa) × dV(m³)

% Calculate work using trapezoidal integration
work_per_cycle = trapz(VLV, PLV) * 133.32 * 0.001;  % Joules per cycle
work_per_minute = work_per_cycle * heart_rate;  % Joules per minute

fprintf('\nWORK CALCULATION:\n');
fprintf('  Work per cycle: %.6f J\n', work_per_cycle);
fprintf('  Work per minute: %.3f J/min\n', work_per_minute);
fprintf('  Formula: Work = ∫ P dV × 133.32 Pa/mmHg × 0.001 m³/L\n');

% Generate detailed cardiac cycle plot with annotations
figure('color','white', 'Position', [100, 100, 1200, 800])

% Plot 1: Pressure-Volume Loop with annotations
subplot(2,2,1)
plot(VLV, PLV, 'linewidth', 2, 'Color', [0.2, 0.6, 0.8])
hold on

% Mark key points
plot(edv, edp, 'ro', 'MarkerSize', 10, 'MarkerFaceColor', 'red')
plot(esv, esp, 'go', 'MarkerSize', 10, 'MarkerFaceColor', 'green')

% Add annotations
text(edv+0.005, edp+5, 'EDV/EDP', 'FontSize', 10, 'FontWeight', 'bold', 'Color', 'red')
text(esv+0.005, esp+5, 'ESV/ESP', 'FontSize', 10, 'FontWeight', 'bold', 'Color', 'green')

title('Cardiac Cycle (Pressure-Volume Loop)', 'FontSize', 14, 'FontWeight', 'bold')
xlabel('Left Ventricular Volume (L)')
ylabel('Left Ventricular Pressure (mmHg)')
grid on
axis([0.01 max(VLV)+0.01 0 max(PLV)+10])

% Plot 2: Volume over time
subplot(2,2,2)
plot(t, VLV, 'linewidth', 2, 'Color', [0.2, 0.6, 0.8])
hold on
plot(t(edv_idx), edv, 'ro', 'MarkerSize', 10, 'MarkerFaceColor', 'red')
plot(t(esv_idx), esv, 'go', 'MarkerSize', 10, 'MarkerFaceColor', 'green')
title('Ventricular Volume Over Time', 'FontSize', 14, 'FontWeight', 'bold')
xlabel('Time (min)')
ylabel('Volume (L)')
legend('Volume', 'EDV', 'ESV', 'Location', 'best')
grid on

% Plot 3: Pressure over time
subplot(2,2,3)
plot(t, PLV, 'linewidth', 2, 'Color', [0.8, 0.2, 0.2])
hold on
plot(t(edv_idx), edp, 'ro', 'MarkerSize', 10, 'MarkerFaceColor', 'red')
plot(t(esv_idx), esp, 'go', 'MarkerSize', 10, 'MarkerFaceColor', 'green')
title('Ventricular Pressure Over Time', 'FontSize', 14, 'FontWeight', 'bold')
xlabel('Time (min)')
ylabel('Pressure (mmHg)')
legend('Pressure', 'EDP', 'ESP', 'Location', 'best')
grid on

% Plot 4: Valve flows with timing
subplot(2,2,4)
plot(t, Qmi, 'linewidth', 2, 'Color', [0.2, 0.6, 0.8])
hold on
plot(t, QAo, 'linewidth', 2, 'Color', [0.8, 0.2, 0.2])
plot(t(mitral_open_idx), Qmi(mitral_open_idx), 'ro', 'MarkerSize', 8)
plot(t(mitral_close_idx), Qmi(mitral_close_idx), 'ro', 'MarkerSize', 8)
plot(t(aortic_open_idx), QAo(aortic_open_idx), 'go', 'MarkerSize', 8)
plot(t(aortic_close_idx), QAo(aortic_close_idx), 'go', 'MarkerSize', 8)
title('Valve Flows with Opening/Closing Points', 'FontSize', 14, 'FontWeight', 'bold')
xlabel('Time (min)')
ylabel('Flow (L/min)')
legend('Mitral', 'Aortic', 'Mitral Open', 'Mitral Close', 'Aortic Open', 'Aortic Close', 'Location', 'best')
grid on

fprintf('\n=== ANALYSIS COMPLETE ===\n');
fprintf('Cardiac cycle analysis completed.\n');
```

================================================================================
END OF COMPLETE HOMEWORK REPORT WITH CODE
================================================================================
